<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>NL Frutas</title>
  <style>
    body { font-family: Arial; background:#f2f2f2; padding:15px }
    input, button { padding:8px; margin:5px; width:100% }
    table { width:100%; border-collapse: collapse; margin-top:10px }
    th, td { border:1px solid #ccc; padding:6px; text-align:center }
    th { background:#333; color:#fff }
    .ok { background:#c8e6c9 }
  </style>
</head>
<body>

<h2>ðŸ“¦ NL FRUTAS â€“ PRIORIZAÃ‡ÃƒO</h2>

<input id="codCliente" placeholder="CÃ³digo da loja">
<input id="nomeCliente" placeholder="Nome da loja">
<input id="codProduto" placeholder="CÃ³digo do produto">
<input id="qtd" placeholder="Quantidade">

<button onclick="adicionar()">âž• Adicionar</button>
<button onclick="carregar()">ðŸ“¥ Carregar Loja</button>

<table id="tabela">
  <thead>
    <tr>
      <th>Produto</th>
      <th>Qtd</th>
      <th>Status</th>
      <th>AÃ§Ã£o</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<script>
function adicionar() {
  google.script.run.adicionarItem(
    codCliente.value,
    nomeCliente.value,
    codProduto.value,
    qtd.value
  );
  alert("Adicionado!");
}

function carregar() {
  google.script.run.withSuccessHandler(mostrar)
    .carregarPorCliente(codCliente.value);
}

function mostrar(dados) {
  const tbody = document.querySelector("#tabela tbody");
  tbody.innerHTML = "";
  dados.forEach((r, i) => {
    const tr = document.createElement("tr");
    if (r[6] === "OK") tr.className = "ok";

    tr.innerHTML = `
      <td>${r[4]}</td>
      <td>${r[5]}</td>
      <td>${r[6]}</td>
      <td>
        ${r[6] === "PENDENTE" ? `<button onclick="ok(${i+2})">OK</button>` : ""}
      </td>
    `;
    tbody.appendChild(tr);
  });
}

function ok(linha) {
  google.script.run.marcarOk(linha);
  carregar();
}
</script>

</body>
</html>
